
///////////////////////////////////////////
// CONFIG /////////////////////////////////
///////////////////////////////////////////

import config from "config";

const port = config.get<number>('port');

///////////////////////////////////////////
// DOT ENV CONFIG /////////////////////////
///////////////////////////////////////////

import dotenv from "dotenv";
dotenv.config();

///////////////////////////////////////////
// EXPRESS ////////////////////////////////
///////////////////////////////////////////

import express from 'express';

///////////////////////////////////////////
// LOCAL //////////////////////////////////
///////////////////////////////////////////

import connect from "./utils/connect";
import logger from "./utils/logger";
import routes from "./routes";
import deserializeUser from './middleware/deserializeUser.middleware';

// INIT APP
const app = express();

app.use(express.json())

app.use(deserializeUser);

app.listen(port, async () => {

    logger.info(`App is running at http://localhost:${port}`);

    // CONNECT TO DB
    await connect();

    // CONNECT ROUTES
    routes(app)
})